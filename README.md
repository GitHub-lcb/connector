# ğŸš€ Connector - ä¸‹ä¸€ä»£ä¼ä¸šçº§è·¯ç”±è½¬å‘ä¸æ•°æ®æ˜ å°„å¹³å°

> **è¿æ¥ä¸‡ç‰©ï¼Œæ™ºé€šæœªæ¥ã€‚**
> 
> Connector æ˜¯ä¸€ä¸ªåŸºäº Spring Boot å’Œ React/Vue çš„å…¨æ ˆä¸­é—´ä»¶è§£å†³æ–¹æ¡ˆï¼Œä¸“æ³¨äºç®€åŒ–å¾®æœåŠ¡é—´çš„ API è·¯ç”±ã€æ•°æ®æ¸…æ´—ä¸åè®®è½¬æ¢ã€‚

---

## ğŸ“š é¡¹ç›®ç®€ä»‹

åœ¨å¾®æœåŠ¡æ¶æ„å’Œé—ç•™ç³»ç»Ÿé›†æˆçš„å¤æ‚åœºæ™¯ä¸‹ï¼ŒConnector å……å½“äº†æ™ºèƒ½ç½‘å…³çš„è§’è‰²ã€‚å®ƒä¸ä»…æ˜¯ä¸€ä¸ªè¯·æ±‚è½¬å‘å™¨ï¼Œæ›´æ˜¯ä¸€ä¸ªå¼ºå¤§çš„**æ•°æ®é€‚é…å™¨**ã€‚é€šè¿‡å¯è§†åŒ–é…ç½®ï¼Œç”¨æˆ·å¯ä»¥è½»æ¾å®šä¹‰è¯·æ±‚å¦‚ä½•ä»æºç«¯æµå‘ç›®æ ‡ç«¯ï¼Œå¹¶åœ¨é€”ä¸­å®Œæˆæ•°æ®çš„"åä¸½è½¬èº«"ã€‚

**æ ¸å¿ƒä»·å€¼ï¼š**
*   **è§£è€¦**ï¼šå‰ç«¯ä¸åç«¯ã€æœåŠ¡ä¸æœåŠ¡ä¹‹é—´çš„æ¥å£å¥‘çº¦è§£è€¦ã€‚
*   **é€‚é…**ï¼šæ–°è€ç³»ç»Ÿå¯¹æ¥æ—¶çš„å­—æ®µæ˜ å°„ä¸æ ¼å¼è½¬æ¢ã€‚
*   **å®‰å…¨**ï¼šæ•æ„Ÿæ•°æ®çš„è‡ªåŠ¨è„±æ•ä¸åŠ å¯†ä¼ è¾“ã€‚
*   **ç›‘æ§**ï¼šå…¨é“¾è·¯çš„è¯·æ±‚æ—¥å¿—è¿½è¸ªä¸å›æ”¾ã€‚

---

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

æœ¬é¡¹ç›®é‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œç¡®ä¿é«˜æ€§èƒ½ä¸æ˜“ç»´æŠ¤æ€§ã€‚

*   **å‰ç«¯ (Frontend)**:
    *   **æ ¸å¿ƒæ¡†æ¶**: Vue 3 + Vite
    *   **UI ç»„ä»¶åº“**: Ant Design Vue (Smart Admin æ¶æ„)
    *   **ç‰¹æ€§**: å“åº”å¼è®¾è®¡ï¼Œæé€Ÿæ„å»ºã€‚
*   **åç«¯ (Backend)**:
    *   **æ ¸å¿ƒæ¡†æ¶**: Spring Boot 2.7 + Java 8
    *   **æŒä¹…å±‚**: MyBatis-Plus
    *   **å®‰å…¨**: Spring Security + JWT
    *   **å·¥å…·**: HttpClient 5 (é«˜æ€§èƒ½è½¬å‘), Jackson (JSON å¤„ç†)
*   **æ•°æ®å­˜å‚¨**: MySQL 5.7+

---

## ğŸŒŸ è¿æ¥å™¨æ¨¡å—ï¼šåŠŸèƒ½è¯¦è§£ (PPT æ ¸å¿ƒç´ æ)

> *ä»¥ä¸‹å†…å®¹ä¸“ä¸ºæ¼”ç¤ºæ–‡æ¡£è®¾è®¡ï¼Œçªå‡ºäº†ç³»ç»Ÿçš„æ ¸å¿ƒèƒ½åŠ›ã€‚è¯·åœ¨ PPT åˆ¶ä½œæ—¶å‚è€ƒä»¥ä¸‹ç»“æ„å’Œæ–‡æ¡ˆï¼Œå¹¶é…åˆç³»ç»Ÿæˆªå›¾ä½¿ç”¨ã€‚*

### 1. ğŸš¦ æ™ºèƒ½è·¯ç”±å¼•æ“ (Intelligent Routing Engine)

Connector çš„å¿ƒè„æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„åŠ¨æ€ä»£ç†å¼•æ“ã€‚å®ƒæ¥ç®¡äº† `/connector/proxy/**` ä¸‹çš„æ‰€æœ‰æµé‡ï¼Œå¹¶æ ¹æ®é…ç½®è§„åˆ™ç²¾ç¡®åˆ†å‘ã€‚

*   **åŠ¨æ€ä»£ç†**: æ— éœ€é‡å¯æœåŠ¡ï¼Œè·¯ç”±è§„åˆ™å³æ—¶ç”Ÿæ•ˆã€‚
*   **å¤šæ¨¡å¼åŒ¹é…**: æ”¯æŒ GET, POST, PUT, DELETE ç­‰å…¨ç³» HTTP æ–¹æ³•ã€‚
*   **ç¯å¢ƒéš”ç¦»**: æ”¯æŒæµ‹è¯•æ¨¡å¼ (`X-Connector-Test`)ï¼Œè®©æ‚¨åœ¨ä¸å½±å“ç”Ÿäº§ç¯å¢ƒçš„æƒ…å†µä¸‹è°ƒè¯•æ–°è·¯ç”±ã€‚

> **[PPT é…å›¾å»ºè®®]**: è¯·åœ¨æ­¤å¤„ç²˜è´´ "è·¯ç”±ç®¡ç†åˆ—è¡¨" é¡µé¢æˆªå›¾ï¼Œå±•ç¤ºè·¯ç”±åç§°ã€æºè·¯å¾„ã€ç›®æ ‡åœ°å€å’ŒçŠ¶æ€å¼€å…³ã€‚

### 2. âš—ï¸ æ•°æ®ç‚¼é‡‘æœ¯ (Data Transformation)

è¿™ä¸ä»…ä»…æ˜¯è½¬å‘ï¼Œè¿™æ˜¯æ•°æ®çš„é‡å¡‘ã€‚é€šè¿‡ `ConnectorTransformService`ï¼Œæˆ‘ä»¬æä¾›äº†å¼ºå¤§çš„æ•°æ®å¤„ç†ç®¡çº¿ï¼š

*   **å­—æ®µæ˜ å°„ (Field Mapping)**: å°†ä¸Šæ¸¸çš„ `user_name` å˜ä¸ºä¸‹æ¸¸çš„ `username`ï¼Œæˆ–è€…å°†æ‰å¹³ç»“æ„è½¬æ¢ä¸ºåµŒå¥—å¯¹è±¡ã€‚
*   **æ•°æ®èšåˆ (Aggregation)**: 
    *   *åœºæ™¯*: åˆ—è¡¨æ•°æ®å­—æ®µè¡¥å…¨ã€‚
    *   *èƒ½åŠ›*: è‡ªåŠ¨ä¿ç•™ä¸»è®°å½•å­—æ®µï¼ˆDeep Copyï¼‰ï¼Œå¹¶å¯¹æ•°å€¼å‹å­—æ®µè¿›è¡Œé«˜ç²¾åº¦ï¼ˆBigDecimalï¼‰æ±‡æ€»è®¡ç®—ã€‚
*   **å®‰å…¨åŠ å›º (Security)**: å†…ç½® RSA åŠ è§£å¯†æ”¯æŒï¼Œç¡®ä¿æ•æ„Ÿä¿¡æ¯åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­å³ä½¿è¢«æˆªè·ä¹Ÿæ— æ³•ç ´è§£ã€‚

> **[PPT é…å›¾å»ºè®®]**: è¯·åœ¨æ­¤å¤„ç²˜è´´ "è·¯ç”±ç¼–è¾‘/é…ç½®" é¡µé¢æˆªå›¾ï¼Œé‡ç‚¹å±•ç¤º "æ•°æ®æ˜ å°„é…ç½®" æˆ– JSON é…ç½®åŒºåŸŸã€‚

### 3. ğŸ›¡ï¸ å…¨é“¾è·¯å¯è§‚æµ‹æ€§ (Full Observability)

æ‹’ç»é»‘ç›’ï¼Connector è®°å½•äº†æ¯ä¸€æ¬¡å‘¼å¸ã€‚

*   **è¯·æ±‚æ—¥å¿— (Request Logging)**: è¯¦ç»†è®°å½•è¯·æ±‚å¤´ã€è¯·æ±‚ä½“ã€å“åº”æ•°æ®ã€è€—æ—¶ä»¥åŠ HTTP çŠ¶æ€ç ã€‚
*   **é…ç½®æ—¶å…‰æœº (Config History)**: è°åœ¨ä»€ä¹ˆæ—¶å€™ä¿®æ”¹äº†è·¯ç”±è§„åˆ™ï¼Ÿå˜æ›´å†å²ä¸€ç›®äº†ç„¶ï¼Œæ”¯æŒé…ç½®å›æº¯ã€‚
*   **å¥åº·å¤§ç›˜**: å®æ—¶ç›‘æ§è·¯ç”±çš„è°ƒç”¨é¢‘ç‡ä¸æˆåŠŸç‡ï¼ˆStats APIï¼‰ã€‚

> **[PPT é…å›¾å»ºè®®]**: è¯·åœ¨æ­¤å¤„ç²˜è´´ "è¯·æ±‚æ—¥å¿—è¯¦æƒ…" é¡µé¢æˆªå›¾ï¼Œå±•ç¤º Request/Response çš„ JSON å¯¹æ¯”ã€‚

### 4. ğŸ§© å¼€å‘è€…å‹å¥½å¥—ä»¶ (Developer Kit)

ä¸ºäº†è®©é›†æˆæµ‹è¯•æ›´ç®€å•ï¼Œæˆ‘ä»¬å†…ç½®äº† Mock æœåŠ¡ä¸­å¿ƒã€‚

*   **Echo å›æ˜¾æœåŠ¡**: å‘é€ä»€ä¹ˆè¿”å›ä»€ä¹ˆï¼Œç”¨äºè°ƒè¯•ç½‘ç»œè¿é€šæ€§å’Œå‚æ•°ä¼ é€’ã€‚
*   **Mock è®¢å•æœåŠ¡**: æ¨¡æ‹ŸçœŸå®çš„ä¸šåŠ¡æ¥å£å»¶è¿Ÿå’Œå“åº”ç»“æ„ï¼Œæ–¹ä¾¿å‰ç«¯åœ¨åç«¯æœªå°±ç»ªæ—¶è¿›è¡Œå¼€å‘ã€‚

> **[PPT é…å›¾å»ºè®®]**: è¯·åœ¨æ­¤å¤„ç²˜è´´ "Mock æœåŠ¡" æˆ– "è·¯ç”±æµ‹è¯•å°" çš„æˆªå›¾ã€‚

---

## ğŸš€ å¿«é€Ÿå¼€å§‹ (Quick Start)

### 1. ç¯å¢ƒå‡†å¤‡
ç¡®ä¿æ‚¨çš„ç”µè„‘å·²å®‰è£…ï¼š
*   JDK 1.8+
*   Node.js 16+
*   MySQL 5.7/8.0
*   Maven 3.6+

### 2. æ•°æ®åº“åˆå§‹åŒ–
1.  åˆ›å»ºæ•°æ®åº“ `connector`ã€‚
2.  æ‰§è¡Œ SQL è„šæœ¬ï¼š
    *   åŸºç¡€è¡¨ç»“æ„: `doc/smart_admin_v3.sql`
    *   è¿æ¥å™¨è¡¨ç»“æ„: `doc/connector.sql`

### 3. å¯åŠ¨åç«¯
```bash
cd smart-admin-api-java8-springboot2/sa-admin
mvn spring-boot:run
```
æœåŠ¡é»˜è®¤è¿è¡Œåœ¨ç«¯å£ `1024` (æˆ– `8081`ï¼Œè§†é…ç½®è€Œå®š)ã€‚
*   Swagger æ–‡æ¡£: `http://localhost:1024/swagger-ui/index.html`

### 4. å¯åŠ¨å‰ç«¯
```bash
cd smart-admin-web-javascript
npm install
npm run dev
```
è®¿é—®åœ°å€: `http://localhost:5173`

---

## ğŸ“‚ ç›®å½•ç»“æ„è¯´æ˜

```text
connector/
â”œâ”€â”€ smart-admin-api-java8-springboot2/  # åç«¯å·¥ç¨‹ (Spring Boot)
â”‚   â”œâ”€â”€ sa-admin/                       # ç®¡ç†ç«¯ API æºç 
â”‚   â”‚   â””â”€â”€ .../module/business/connector/ # â˜… è¿æ¥å™¨æ ¸å¿ƒä¸šåŠ¡ä»£ç 
â”‚   â””â”€â”€ sa-base/                        # åŸºç¡€æ¡†æ¶ä»£ç 
â”œâ”€â”€ smart-admin-web-javascript/         # å‰ç«¯å·¥ç¨‹ (Vue 3)
â”‚   â”œâ”€â”€ src/api/business/connector/     # è¿æ¥å™¨å‰ç«¯ API
â”‚   â”œâ”€â”€ src/router/business/            # è¿æ¥å™¨è·¯ç”±é…ç½®
â”‚   â””â”€â”€ ...
â””â”€â”€ doc/                                # æ•°æ®åº“è„šæœ¬ä¸æ–‡æ¡£
```

---

## â“ å¸¸è§é—®é¢˜

**Q: ä»£ç†è¯·æ±‚æŠ¥ 404ï¼Ÿ**
A: è¯·æ£€æŸ¥è·¯ç”±é…ç½®ä¸­çš„ `Source Path` æ˜¯å¦ä¸è¯·æ±‚è·¯å¾„å®Œå…¨åŒ¹é…ï¼Œå¹¶ç¡®è®¤è·¯ç”±çŠ¶æ€å·²è®¾ç½®ä¸º `Active`ï¼ˆå¼€å¯ï¼‰ã€‚

**Q: å¦‚ä½•é…ç½®æ•°æ®åº“è¿æ¥ï¼Ÿ**
A: ä¿®æ”¹ `smart-admin-api-java8-springboot2/sa-admin/src/main/resources/dev/application.yaml` ä¸­çš„ datasource é…ç½®ã€‚
